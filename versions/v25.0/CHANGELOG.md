# CHANGELOG - v24.1 (UI全面改善 + 大規模機能改善版)

## 概要
ファイル分割、品質向上、新機能追加、運用効率化を含む大規模アップデート。
v24.1でUI全面改善を実施（スマホ/PC両対応）。

## 変更内容

### 🔧 アーキテクチャ改善
- **ファイル分割**: 2ファイル → 9ファイル構成
  - Config.gs - 設定定数
  - Validator.gs - 入力バリデーション
  - Logger.gs - 操作ログ
  - Masters.gs - マスターデータ管理 (キャッシュ対応)
  - Notify.gs - 通知機能
  - Orders.gs - 発注CRUD・一括操作・統計
  - Code.gs - エントリーポイント
  - styles.html - CSS分離
  - scripts.html - JavaScript分離
  - index.html - HTML

### 🛡️ 品質向上
- **エラーハンドリング強化**
  - 統一エラーレスポンス形式 `{ success, message, code }`
  - エラーコード定義
- **入力バリデーション**
  - 必須項目チェック
  - 文字数制限
  - 日付形式検証
  - 入力サニタイズ

### ✨ 新機能

#### 担当者変更機能
- 編集モーダルで担当者をドロップダウンから選択可能
- カレンダーイベントのゲスト自動更新
- 変更通知の自動送信

#### キャッシュ機能
- スタッフ・患者マスターを10分間キャッシュ
- 読み込み速度向上

#### フィルター・検索機能
- ステータスフィルター (未発注/発注済)
- 担当者フィルター
- 患者名・薬剤名テキスト検索

#### 操作ログ機能
- 全操作を「操作ログ」シートに記録
- 記録内容: 日時/操作/対象ID/詳細/実行者

#### 一括操作
- チェックボックスで複数選択
- 一括ステータス変更 (発注済)
- 一括削除

#### 統計ダッシュボード
- 年度別集計 (4月〜3月)
- 月別発注件数グラフ
- 担当者別件数グラフ
- サマリー表示 (年間件数/未発注/発注済/期限超過)

### 🎨 UI全面改善 (v24.1)
- **新規登録ボタンを画面上部に大きく配置**
- **ステータスフィルターをタブ化** (すべて/未発注/発注済)
- **ボトムナビゲーション追加** (リスト/カレンダー/統計)
- **カード左側に色付きボーダー** でステータス視認性向上
- **期限超過カードを赤背景でハイライト**
- **モーダルをボトムシート形式に** (スマホ操作性向上)
- **PC表示で2カラムグリッド** (一覧性向上)
- **大きなタッチターゲット** (44px以上)

### 📅 カレンダー機能 (v24.1)
- **月間カレンダービュー** で発注期限を視覚的に確認
- **日付にドット表示** (赤=未発注、オレンジ=発注済)
- **日付タップでポップオーバー** からその日の発注一覧を確認・編集
- **月の前後切り替え** ボタンで簡単にナビゲーション
- **今日ボタン** で当月に即座に戻る
- **PC/スマホ両対応** レスポンシブデザイン

## ファイル構成

```
versions/v24.0/
├── Config.gs       # 設定定数
├── Validator.gs    # バリデーション
├── Logger.gs       # ログ機能
├── Masters.gs      # マスターデータ
├── Notify.gs       # 通知
├── Orders.gs       # 発注CRUD・統計
├── Code.gs         # エントリーポイント
├── styles.html     # CSS
├── scripts.html    # JavaScript
├── index.html      # HTML
└── CHANGELOG.md    # 本ファイル
```

## 移行手順

1. データDBスプレッドシートに「操作ログ」シートを作成
   - カラム: 日時 / 操作 / 対象ID / 詳細 / 実行者
2. GASプロジェクトに全ファイルをコピー
3. 新しいデプロイを作成

## デプロイ情報
- デプロイID: [記入してください]
- デプロイ日時: [記入してください]
- デプロイ者: [記入してください]
