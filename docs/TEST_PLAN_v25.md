# 薬剤発注ナビ v25.0 テスト仕様書

**バージョン**: v25.0  
**作成日**: 2026-01-16  
**対象**: 定期発注機能、新Uデザイン、オートコンプリート機能

---

## 1. テスト環境
- **URL**: (デプロイURL)
- **ブラウザ**: Chrome (PC / Mobile)
- **ユーザー**: 権限のあるドメインアカウント

---

## 2. テストケース一覧

### 2.1 起動・表示
| ID | テスト項目 | 手順 | 期待値 | 確認 |
|----|-----------|------|-------|------|
| TC-01 | ローディング画面 | アプリを開く | スキップボタンが表示されず、ロード完了後に自動でメイン画面に遷移すること | |
| TC-02 | デザイン表示 | メイン画面を確認 | ライムグリーン基調の「ナチュラル×ポップ」デザインが適用されていること | |

### 2.2 担当者オートコンプリート
| ID | テスト項目 | 手順 | 期待値 | 確認 |
|----|-----------|------|-------|------|
| TC-03 | 候補表示 | 担当者フィルターに名前の一部を入力 | 一致するスタッフの候補リストが表示されること | |
| TC-04 | 絞り込み実行 | 候補をクリック | リストがその担当者でフィルタリングされ、クリアボタンが表示されること | |
| TC-05 | クリア機能 | クリアボタン(×)をクリック | 入力が消え、フィルタリングが解除されて全件表示に戻ること | |

### 2.3 定期発注登録
| ID | テスト項目 | 手順 | 期待値 | 確認 |
|----|-----------|------|-------|------|
| TC-06 | 毎週登録 | 新規登録で「定期: 毎週水曜日」を選択して登録 | ・リストに初回分(直近の水曜)が作成されること<br>・Statusが「Template」の親レコードがDBに作成されること | |
| TC-07 | 隔週登録 | 新規登録で「定期: 隔週木曜日」を選択して登録 | ・初回の発注日が基準日から偶数週目の木曜日になっていること | |
| TC-08 | 毎月(日付) | 新規登録で「定期: 毎月15日」を選択して登録 | ・直近の15日が初回データとして作成されること | |
| TC-09 | 毎月(曜日) | 新規登録で「定期: 毎月第2金曜」を選択して登録 | ・直近の第2金曜日が初回データとして作成されること | |

### 2.4 バッチ処理 (自動生成)
| ID | テスト項目 | 手順 | 期待値 | 確認 |
|----|-----------|------|-------|------|
| TC-10 | 自動生成実行 | GASエディタから `doDailyRecurrenceCheck` を手動実行 | ・向こう30日分の予定データが自動生成されること<br>・ログに生成件数が出力されること | |
| TC-11 | 重複防止 | 同一日に再度 `doDailyRecurrenceCheck` を実行 | ・同じ日付・薬剤のデータが二重に作成されないこと | |

### 2.5 編集・キャンセル・削除
| ID | テスト項目 | 手順 | 期待値 | 確認 |
|----|-----------|------|-------|------|
| TC-12 | 単発編集 | 既存の注文を選択し、日付や数量を変更して保存 | ・変更内容がリストとDBに反映されること | |
| TC-13 | 定期キャンセル(今回のみ) | 定期発注データを選択し「この予定を削除」→「この予定のみ」を選択 | ・キャンセルモーダルで選択肢が表示されること<br>・「今回のみ」選択で対象のみキャンセルされること | |
| TC-14 | 定期キャンセル(シリーズ) | 定期発注データを選択し「この予定を削除」→「今後すべて停止」を選択 | ・「今後すべて」を選択すると、以降の自動生成が停止されること | |

---

## 3. ソースコードレビュー結果概略

ソースコードと仕様書（`specification_v25.md`）の比較結果：

### ✅ 一致/実装済み
- **定期設定ロジック**: `Orders.gs` の `calculateNextDates` は仕様通り正確に実装されています。
- **DB構造**: `Config.gs` のカラム定義は仕様書と一致しています。
- **UI/UX**: ローディング画面の改善、担当者フィルターのオートコンプリート化は実装済みです。
- **定期発注のキャンセル機能**: 仕様書 4.3項および5.2項の「今回のみキャンセル / 今後すべてキャンセル」UIが実装済みです。

### 追加実装 (2026-01-16)
- `index.html`: キャンセル確認モーダル追加
- `styles.html`: キャンセルモーダルのCSS追加
- `scripts.html`: `confirmDelete`, `executeCancel` 関数追加
