# 薬剤発注ナビ バージョン管理ルール

**最終更新**: 2026-01-02

---

## 1. バージョン番号ルール

### 1.1 形式
```
vX.Y (説明)
```

| 部分 | 意味 | 例 |
|------|------|---|
| X | メジャーバージョン (大幅な機能追加・構成変更) | 23, 24 |
| Y | マイナーバージョン (バグ修正・小機能追加) | 0, 1, 2 |
| 説明 | 変更の概要 | 患者検索修正版 |

### 1.2 バージョンアップ基準

| 変更内容 | バージョンアップ |
|---------|-----------------|
| 新機能追加・ファイル構成変更 | メジャー (23→24) |
| バグ修正・UI微調整 | マイナー (24.0→24.1) |

---

## 2. フォルダ構成

```
薬剤発注ナビ/
├── SRC/                    # 現行本番ソース
│   ├── code.gs
│   └── index.html
│
├── versions/               # バージョン履歴
│   ├── v23.0/
│   │   ├── code.gs
│   │   ├── index.html
│   │   └── CHANGELOG.md
│   └── v24.0/
│       ├── Config.gs
│       ├── Masters.gs
│       ├── ...
│       └── CHANGELOG.md
│
└── docs/                   # ドキュメント
    ├── specification_v23.md    # v23仕様書
    ├── specification_v24.md    # v24仕様書
    ├── VERSION_CONTROL.md      # 本ファイル
    └── HANDOVER.md             # 引継ぎ資料
```

---

## 3. バージョン管理手順

### 3.1 新バージョン開発時

1. `versions/vX.Y/` フォルダを作成
2. 現行ソースをコピー
3. 変更を実施
4. `CHANGELOG.md` に変更内容を記録
5. テスト完了後、`SRC/` にコピーして本番反映

### 3.2 本番反映手順

1. `SRC/` 内のファイルを GAS プロジェクトに貼り付け
2. GAS エディタで「デプロイ」→「新しいデプロイ」
3. デプロイIDを記録

### 3.3 ロールバック手順

1. `versions/` から戻したいバージョンのソースを取得
2. GAS プロジェクトに貼り付け
3. 再デプロイ

---

## 4. 各ファイルのバージョン表記

### 4.1 code.gs / Config.gs
ファイル先頭にコメントでバージョン情報を記載:

```javascript
/**
 * 薬剤発注ナビ v24.0
 * [機能名]
 * 最終更新: 2026-01-02
 */
```

### 4.2 index.html
`<head>` 内にメタ情報として記載:

```html
<!-- 薬剤発注ナビ v24.0 - 最終更新: 2026-01-02 -->
```

---

## 5. CHANGELOG.md テンプレート

各バージョンフォルダに以下の形式で作成:

```markdown
# CHANGELOG - v24.0

## 概要
[このバージョンの主な変更点]

## 変更内容

### 新機能
- 機能1
- 機能2

### 改善
- 改善1

### バグ修正
- 修正1

## 影響範囲
- 影響を受ける機能・画面

## 移行手順
- 必要な手順があれば記載

## デプロイ情報
- デプロイID: [xxxxxx]
- デプロイ日時: 2026-01-02
- デプロイ者: [名前]
```

---

## 6. 注意事項

1. **本番反映前に必ずバックアップ**: `versions/` にコピー済みか確認
2. **デプロイIDの記録**: ロールバック時に必要
3. **仕様書の同期**: コード変更時は仕様書も必ず更新
