# 薬剤発注ナビ v25.0 機能追加要件メモ

**作成日**: 2026年1月7日  
**ステータス**: 📋 メモ（明日以降着手予定）

---

## 1. 定期発注パターン選択機能

### 概要
発注登録時に繰り返しパターンを選択できるようにする。

### 選択肢（案）
| パターン | 説明 | 例 |
|---------|------|-----|
| 毎週〇曜日 | 毎週特定の曜日に発注 | 毎週水曜日 |
| 毎月第○〇曜日 | 月の特定週と曜日に発注 | 毎月第1火曜日 |
| 毎月○日 | 月の特定日に発注 | 毎月15日 |
| 隔週〇曜日 | 2週間ごとに発注 | 隔週月曜日 |

### UI案
```
📅 発注頻度
○ 単発
○ 定期（繰り返し）
  └ パターン: [毎週 ▼] [水曜日 ▼]
```

---

## 2. キャンセル種別機能

### 概要
定期発注のキャンセル時に、対象範囲を選択できるようにする。

### キャンセル種別
| 種別 | 説明 | 影響範囲 |
|------|------|---------|
| **この回のみ** | 選択した1回分だけキャンセル | 次回以降は継続 |
| **全部キャンセル** | 定期発注全体をキャンセル | 今後の発注もすべて停止 |

### UI案
```
キャンセル確認

この発注をキャンセルしますか？

○ この回のみキャンセル（次回以降は継続）
○ すべてキャンセル（定期発注を停止）

[キャンセル] [実行]
```

---

## 3. データベース変更（想定）

### 追加列（案）
| 列 | フィールド名 | 説明 |
|----|------------|------|
| 新規 | RECURRENCE_TYPE | 繰り返しタイプ（weekly/monthly_nth_day/monthly_date） |
| 新規 | RECURRENCE_VALUE | 繰り返し値（曜日番号、第○週+曜日 など） |
| 新規 | PARENT_ORDER_ID | 親オーダーID（定期発注のグループ化用） |
| 新規 | IS_CANCELLED | キャンセルフラグ（個別キャンセル用） |
| 新規 | SERIES_CANCELLED | シリーズキャンセルフラグ（全体キャンセル用） |

---

## 4. 次のステップ

1. [ ] 現行v24.0のコードを確認
2. [ ] データベース設計の確定
3. [ ] UI/UXデザインの決定
4. [ ] 実装計画書の作成
5. [ ] 実装・テスト

---

*このメモは明日以降の作業開始時に参照してください*
